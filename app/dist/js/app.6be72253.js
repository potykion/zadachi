(function(t){function e(e){for(var a,r,i=e[0],c=e[1],u=e[2],d=0,f=[];d<i.length;d++)r=i[d],s[r]&&f.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==s[c]&&(a=!1)}a&&(o.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},o=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"05c2":function(t,e,n){"use strict";var a=n("894d"),s=n.n(a);s.a},1843:function(t,e,n){},"3c56":function(t,e,n){"use strict";var a=n("80e8"),s=n.n(a);s.a},"3d72":function(t,e,n){"use strict";var a=n("1843"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("AuthRequired",[n("DateRow"),n("TaskList")],1)],1)])},o=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.authorized?n("div",[t._t("default")],2):n("div",[n("input",{attrs:{id:"enterAuth",type:"password",placeholder:"Enter auth env"},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.requestToken(e):null}}})])])},i=[],c={name:"AuthRequired",methods:{requestToken:function(t){this.$store.dispatch("requestToken",t.target.value)}},computed:{authorized:function(){return this.$store.getters.authorized}},mounted:function(){localStorage.token&&this.$store.commit("setupAxios",localStorage.token)}},u=c,l=(n("3c56"),n("2877")),d=Object(l["a"])(u,r,i,!1,null,"b7e3c2d2",null);d.options.__file="AuthRequired.vue";var f=d.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.tasksLoaded?n("ul",{staticClass:"task-list"},t._l(t.tasks,function(e){return n("TaskItem",t._b({key:e.id},"TaskItem",e,!1,!0))}),1):n("div",{staticClass:"loading-label"},[t._v("Ща все будет...")])])},k=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",{staticClass:"task-li"},[n("span",[t._v("–")]),t.completed_date?n("textarea",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"task completed",attrs:{readonly:""},domProps:{value:t.title},on:{dblclick:t.resetTask}}):n("textarea",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"task",domProps:{value:t.title},on:{input:function(e){t.$emit("update:title",e.target.value)},change:t.taskChanged,keydown:[function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.preventDefault(),t.taskChanged(e)):null},t.fit],dblclick:t.completeTask}})])])},m=[],v=function(t){t.style.height="1px",t.style.height=t.scrollHeight-4+"px"},T=n("da34"),b={name:"TaskItem",components:{FlatPickr:T["a"]},props:["title","id","completed_date"],methods:{taskChanged:function(t){""!==this.$store.getters.lastTask.title&&this.$store.commit("appendBlankTask");var e=this.task;""!==e.title&&(e.new?this.$store.dispatch("createTask",e):this.$store.dispatch("updateTask",e)),v(t.target)},fit:function(t){console.log("fit"),v(t.target)},completeTask:function(t){this.$store.dispatch("completeTask",this.task)},resetTask:function(){this.$store.dispatch("resetTask",this.task)}},computed:{task:function(){return this.$store.getters.getTaskById(this.id)}}},_=b,g=(n("e8ca"),Object(l["a"])(_,h,m,!1,null,"034c30b9",null));g.options.__file="TaskItem.vue";var x=g.exports,w={name:"TaskList",components:{TaskItem:x},computed:{tasksLoaded:function(){return this.$store.state.tasksLoaded},tasks:function(){return this.$store.state.tasks}},mounted:function(){this.$store.commit("appendBlankTask"),this.$store.dispatch("refreshTasks")}},y=w,O=(n("05c2"),Object(l["a"])(y,p,k,!1,null,"35e1de27",null));O.options.__file="TaskList.vue";var $=O.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("flat-pickr",{staticClass:"date",model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)},I=[],C=n("cebc"),L=n("2f62"),D=n("c38f"),A=n.n(D),P=(n("0952"),{name:"DateRow",props:["date"],components:{FlatPickr:A.a},computed:Object(C["a"])({},Object(L["b"])(["currentDate"]))}),R=P,S=(n("3d72"),Object(l["a"])(R,j,I,!1,null,"e89d1c62",null));S.options.__file="DateRow.vue";var q=S.exports,E={name:"app",components:{DateRow:q,AuthRequired:f,TaskList:$}},N=E,z=(n("034f"),Object(l["a"])(N,s,o,!1,null,null,null));z.options.__file="App.vue";var B=z.exports,M=(n("20d6"),n("7514"),n("75fc")),J=n("0a0d"),F=n.n(J),H=n("bc3a"),U=n.n(H),W=n("c64e"),G=n.n(W);a["a"].use(L["a"]);var K="",Q=new L["a"].Store({state:{tasksLoaded:!1,tasks:[],axiosInstance:null,currentDate:F()()},mutations:{appendBlankTask:function(t){t.tasks=[].concat(Object(M["a"])(t.tasks),[{title:"",id:G()(),new:!0}])},setupAxios:function(t,e){t.axiosInstance=U.a.create({headers:{Authorization:"JWT ".concat(e)},baseURL:K})},setTasks:function(t,e){t.tasks=[].concat(Object(M["a"])(e),Object(M["a"])(t.tasks))},setTasksLoaded:function(t){t.tasksLoaded=!0},setCreatedTask:function(t,e){var n=e.oldTask,a=e.newTask,s=this.getters.getTaskIndex(n.id);t.tasks=[].concat(Object(M["a"])(t.tasks.slice(0,s)),[a],Object(M["a"])(t.tasks.slice(s-t.tasks.length+1)))},setTaskNotNew:function(t,e){e.new=!1},setTaskCompleted:function(t,e){e.completed_date=new Date},setTaskIncomplete:function(t,e){e.completed_date=null}},actions:{requestToken:function(t,e){var n=t.commit;t.dispatch;U.a.post("".concat(K,"/login_via_env/").concat(e)).then(function(t){var e=localStorage.token=t.data.token;n("setupAxios",e)}).catch(function(t){alert(t.response.data.error)})},refreshTasks:function(t){var e=t.commit,n=t.state;n.axiosInstance.get("/tasks").then(function(t){e("setTasks",t.data),e("setTasksLoaded")})},createTask:function(t,e){var n=t.commit,a=t.state;n("setTaskNotNew",e),a.axiosInstance.post("/tasks/create",e).then(function(t){n("setCreatedTask",{oldTask:e,newTask:t.data})})},updateTask:function(t,e){var n=t.state;n.axiosInstance.post("/tasks/".concat(e.id,"/update"),{title:e.title})},completeTask:function(t,e){var n=t.commit,a=t.state;n("setTaskCompleted",e),a.axiosInstance.post("/tasks/".concat(e.id,"/update"),{completed_date:e.completed_date})},resetTask:function(t,e){var n=t.commit,a=t.state;n("setTaskIncomplete",e),a.axiosInstance.post("/tasks/".concat(e.id,"/update"),{completed_date:e.completed_date})}},getters:{lastTask:function(t){return t.tasks[t.tasks.length-1]},authorized:function(t){return null!==t.axiosInstance},getTaskById:function(t){return function(e){return t.tasks.find(function(t){return t.id===e})}},getTaskIndex:function(t){return function(e){return t.tasks.findIndex(function(t){return t.id===e})}}}});a["a"].config.productionTip=!1,new a["a"]({store:Q,render:function(t){return t(B)}}).$mount("#app"),a["a"].directive("focus",{inserted:function(t){v(t),t.focus()}})},"64a9":function(t,e,n){},7799:function(t,e,n){},"80e8":function(t,e,n){},"894d":function(t,e,n){},e8ca:function(t,e,n){"use strict";var a=n("7799"),s=n.n(a);s.a}});
//# sourceMappingURL=app.6be72253.js.map