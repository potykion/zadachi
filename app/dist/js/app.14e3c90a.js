(function(t){function e(e){for(var s,i,r=e[0],c=e[1],u=e[2],d=0,f=[];d<r.length;d++)i=r[d],a[i]&&f.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(s=!1)}s&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},a={app:0},o=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var s=n("64a9"),a=n.n(s);a.a},"0648":function(t,e,n){"use strict";var s=n("0cd9"),a=n.n(s);a.a},"0cd9":function(t,e,n){},2400:function(t,e,n){},"3c56":function(t,e,n){"use strict";var s=n("80e8"),a=n.n(s);a.a},5249:function(t,e,n){"use strict";var s=n("2400"),a=n.n(s);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var s=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("AuthRequired",[n("TaskList")],1)],1)])},o=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.authorized?n("div",[t._t("default")],2):n("div",[n("input",{attrs:{id:"enterAuth",type:"password",placeholder:"Enter auth env"},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.requestToken(e):null}}})])])},r=[],c={name:"AuthRequired",methods:{requestToken:function(t){this.$store.dispatch("requestToken",t.target.value)}},computed:{authorized:function(){return this.$store.getters.authorized}},mounted:function(){localStorage.token&&this.$store.commit("setupAxios",localStorage.token)}},u=c,l=(n("3c56"),n("2877")),d=Object(l["a"])(u,i,r,!1,null,"b7e3c2d2",null);d.options.__file="AuthRequired.vue";var f=d.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.tasksLoaded?n("ul",{staticClass:"task-list"},t._l(t.tasks,function(e){return n("TaskItem",t._b({key:e.id},"TaskItem",e,!1,!0))}),1):n("div",{staticClass:"loading-label"},[t._v("Ща все будет...")])])},k=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",{staticClass:"task-li"},[n("span",[t._v("–")]),t.completed_date?n("textarea",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"task completed",attrs:{readonly:""},domProps:{value:t.title},on:{dblclick:t.resetTask}}):n("textarea",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"task",domProps:{value:t.title},on:{input:function(e){t.$emit("update:title",e.target.value)},change:t.taskChanged,keydown:[function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.preventDefault(),t.taskChanged(e)):null},t.fit],dblclick:t.completeTask}})])])},m=[],v=function(t){t.style.height="1px",t.style.height=t.scrollHeight-4+"px"},T={name:"TaskItem",props:["title","id","completed_date"],methods:{taskChanged:function(t){""!==this.$store.getters.lastTask.title&&this.$store.commit("appendBlankTask");var e=this.task;""!==e.title&&(e.new?this.$store.dispatch("createTask",e):this.$store.dispatch("updateTask",e)),v(t.target)},fit:function(t){console.log("fit"),v(t.target)},completeTask:function(t){this.$store.dispatch("completeTask",this.task)},resetTask:function(){this.$store.dispatch("resetTask",this.task)}},computed:{task:function(){return this.$store.getters.getTaskById(this.id)}}},g=T,_=(n("5249"),Object(l["a"])(g,h,m,!1,null,"3796a91c",null));_.options.__file="TaskItem.vue";var b=_.exports,x={name:"TaskList",components:{TaskItem:b},computed:{tasksLoaded:function(){return this.$store.state.tasksLoaded},tasks:function(){return this.$store.state.tasks}},mounted:function(){this.$store.commit("appendBlankTask"),this.$store.dispatch("refreshTasks")}},y=x,w=(n("0648"),Object(l["a"])(y,p,k,!1,null,"62580242",null));w.options.__file="TaskList.vue";var I=w.exports,$={name:"app",components:{AuthRequired:f,TaskList:I}},O=$,j=(n("034f"),Object(l["a"])(O,a,o,!1,null,null,null));j.options.__file="App.vue";var C=j.exports,L=(n("20d6"),n("7514"),n("75fc")),A=n("2f62"),S=n("bc3a"),q=n.n(S),P=n("c64e"),E=n.n(P);s["a"].use(A["a"]);var N="",z=new A["a"].Store({state:{tasksLoaded:!1,tasks:[],axiosInstance:null},mutations:{appendBlankTask:function(t){t.tasks=[].concat(Object(L["a"])(t.tasks),[{title:"",id:E()(),new:!0}])},setupAxios:function(t,e){t.axiosInstance=q.a.create({headers:{Authorization:"JWT ".concat(e)},baseURL:N})},setTasks:function(t,e){t.tasks=[].concat(Object(L["a"])(e),Object(L["a"])(t.tasks))},setTasksLoaded:function(t){t.tasksLoaded=!0},setCreatedTask:function(t,e){var n=e.oldTask,s=e.newTask,a=this.getters.getTaskIndex(n.id);t.tasks=[].concat(Object(L["a"])(t.tasks.slice(0,a)),[s],Object(L["a"])(t.tasks.slice(a-t.tasks.length+1)))},setTaskNotNew:function(t,e){e.new=!1},setTaskCompleted:function(t,e){e.completed_date=new Date},setTaskIncomplete:function(t,e){e.completed_date=null}},actions:{requestToken:function(t,e){var n=t.commit;t.dispatch;q.a.post("".concat(N,"/login_via_env/").concat(e)).then(function(t){var e=localStorage.token=t.data.token;n("setupAxios",e)}).catch(function(t){alert(t.response.data.error)})},refreshTasks:function(t){var e=t.commit,n=t.state;n.axiosInstance.get("/tasks").then(function(t){e("setTasks",t.data),e("setTasksLoaded")})},createTask:function(t,e){var n=t.commit,s=t.state;n("setTaskNotNew",e),s.axiosInstance.post("/tasks/create",e).then(function(t){n("setCreatedTask",{oldTask:e,newTask:t.data})})},updateTask:function(t,e){var n=t.state;n.axiosInstance.post("/tasks/".concat(e.id,"/update"),{title:e.title})},completeTask:function(t,e){var n=t.commit,s=t.state;n("setTaskCompleted",e),s.axiosInstance.post("/tasks/".concat(e.id,"/update"),{completed_date:e.completed_date})},resetTask:function(t,e){var n=t.commit,s=t.state;n("setTaskIncomplete",e),s.axiosInstance.post("/tasks/".concat(e.id,"/update"),{completed_date:e.completed_date})}},getters:{lastTask:function(t){return t.tasks[t.tasks.length-1]},authorized:function(t){return null!==t.axiosInstance},getTaskById:function(t){return function(e){return t.tasks.find(function(t){return t.id===e})}},getTaskIndex:function(t){return function(e){return t.tasks.findIndex(function(t){return t.id===e})}}}});s["a"].config.productionTip=!1,new s["a"]({store:z,render:function(t){return t(C)}}).$mount("#app"),s["a"].directive("focus",{inserted:function(t){v(t),t.focus()}})},"64a9":function(t,e,n){},"80e8":function(t,e,n){}});
//# sourceMappingURL=app.14e3c90a.js.map